# EVerest OCPP 1.6 –¥–ª—è –ö—ñ–±–µ—Ä–ø–æ–ª—ñ–≥–æ–Ω—É

**ChargePointId:** CP001  
**–ü—Ä–æ—Ç–æ–∫–æ–ª:** OCPP 1.6  
**–°–µ—Ä–≤–µ—Ä EVerest:** 172.16.0.40  
**–°–µ—Ä–≤–µ—Ä CitrineOS:** 192.168.20.20  

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª—ñ–≤

```
everest-deploy/
‚îú‚îÄ‚îÄ docker-compose.yml    # Docker Compose –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è
‚îú‚îÄ‚îÄ Dockerfile            # –û–±—Ä–∞–∑ EVerest
‚îú‚îÄ‚îÄ config-docker.json    # –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è OCPP 1.6
‚îú‚îÄ‚îÄ my-config.yaml        # –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è EVerest –º–æ–¥—É–ª—ñ–≤
‚îú‚îÄ‚îÄ start.sh              # –°–∫—Ä–∏–ø—Ç –∑–∞–ø—É—Å–∫—É
‚îú‚îÄ‚îÄ .env                  # –ó–º—ñ–Ω–Ω—ñ —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞
‚îú‚îÄ‚îÄ deploy.sh             # –°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ–≥–æ —Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è
‚îî‚îÄ‚îÄ README.md             # –¶–µ–π —Ñ–∞–π–ª
```

---

## üöÄ –®–≤–∏–¥–∫–∏–π —Å—Ç–∞—Ä—Ç

### –ö—Ä–æ–∫ 1: –°–∫–æ–ø—ñ—é–π—Ç–µ —Ñ–∞–π–ª–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä EVerest

```bash
# –ù–∞ —Å–µ—Ä–≤–µ—Ä—ñ 172.16.0.40
mkdir -p ~/everest && cd ~/everest

# –°–∫–æ–ø—ñ—é–π—Ç–µ –≤—Å—ñ —Ñ–∞–π–ª–∏ –∑ —Ü—ñ—î—ó –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—ó
```

### –ö—Ä–æ–∫ 2: –ó–∞–ø—É—Å—Ç—ñ—Ç—å —Å–∫—Ä–∏–ø—Ç —Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è

```bash
chmod +x deploy.sh
./deploy.sh
```

### –ö—Ä–æ–∫ 3: –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è

1. **EVerest UI:** http://172.16.0.40:1880/ui/
2. **CitrineOS UI:** http://192.168.20.20:3000/

–í CitrineOS UI –ø–æ–≤–∏–Ω–Ω–∞ –∑'—è–≤–∏—Ç–∏—Å—å —Å—Ç–∞–Ω—Ü—ñ—è `CP001`.

---

## üîß –†—É—á–Ω–µ —Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è

### 1. –í—Å—Ç–∞–Ω–æ–≤—ñ—Ç—å Docker (—è–∫—â–æ –Ω–µ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ)

```bash
curl -fsSL https://get.docker.com | sudo sh
sudo apt install -y docker-compose-plugin
sudo usermod -aG docker $USER
# –í–∏–π–¥—ñ—Ç—å —Ç–∞ –∑–∞–π–¥—ñ—Ç—å –∑–Ω–æ–≤—É
```

### 2. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –∑'—î–¥–Ω–∞–Ω–Ω—è –∑ CitrineOS

```bash
# –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—ñ –ø–æ—Ä—Ç—É
nc -zv 192.168.20.20 8092

# –ê–±–æ —á–µ—Ä–µ–∑ curl
curl -v http://192.168.20.20:8092
# (–º–∞—î –ø–æ–≤–µ—Ä–Ω—É—Ç–∏ "Upgrade Required" - —Ü–µ –æ–∑–Ω–∞—á–∞—î WebSocket –ø—Ä–∞—Ü—é—î)
```

### 3. –ó–∞–ø—É—Å—Ç—ñ—Ç—å EVerest

```bash
cd ~/everest
chmod +x start.sh
docker compose up -d --build
```

### 4. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –ª–æ–≥–∏

```bash
# –í—Å—ñ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏
docker compose ps

# –õ–æ–≥–∏ manager
docker compose logs -f manager
```

---

## üåê –ú–µ—Ä–µ–∂–µ–≤–∞ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è

### –ü–æ—Ä—Ç–∏ EVerest (172.16.0.40)

| –ü–æ—Ä—Ç | –ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è |
|------|-------------|
| 1880 | NodeRed UI / EVerest Simulator UI |
| 8888 | OCPP Logs viewer |

### –ü–æ—Ä—Ç–∏ CitrineOS (192.168.20.20)

| –ü–æ—Ä—Ç | –ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è |
|------|-------------|
| 8092 | OCPP 1.6 WebSocket |
| 3000 | CitrineOS UI |

### –§–∞—î—Ä–≤–æ–ª –Ω–∞ CitrineOS (—è–∫—â–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ)

```bash
# –ù–∞ —Å–µ—Ä–≤–µ—Ä—ñ 192.168.20.20
sudo ufw allow from 172.16.0.40 to any port 8092
```

---

## üìù –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è

### –§–∞–π–ª config-docker.json

–û—Å–Ω–æ–≤–Ω—ñ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏:

```json
{
    "Internal": {
        "ChargePointId": "CP001",
        "CentralSystemURI": "ws://192.168.20.20:8092/CP001",
        ...
    }
}
```

### –§–∞–π–ª .env

```bash
EVEREST_IMAGE_TAG=0.0.23
EVEREST_TARGET_URL=ws://192.168.20.20:8092/CP001
OCPP_VERSION=one
```

---

## üîå –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è EVerest UI

1. –í—ñ–¥–∫—Ä–∏–π—Ç–µ http://172.16.0.40:1880/ui/
2. –í–∏ –ø–æ–±–∞—á–∏—Ç–µ —Å–∏–º—É–ª—è—Ç–æ—Ä –∑–∞—Ä—è–¥–Ω–æ—ó —Å—Ç–∞–Ω—Ü—ñ—ó –∑ 2 –∫–æ–Ω–µ–∫—Ç–æ—Ä–∞–º–∏
3. –î–æ—Å—Ç—É–ø–Ω—ñ –¥—ñ—ó:
   - **Plug** ‚Äî –ø—ñ–¥–∫–ª—é—á–∏—Ç–∏ EV
   - **Unplug** ‚Äî –≤—ñ–¥–∫–ª—é—á–∏—Ç–∏ EV
   - **Start Charging** ‚Äî –ø–æ—á–∞—Ç–∏ –∑–∞—Ä—è–¥–∫—É
   - **Stop Charging** ‚Äî –∑—É–ø–∏–Ω–∏—Ç–∏ –∑–∞—Ä—è–¥–∫—É

---

## üîç –ü–µ—Ä–µ–≥–ª—è–¥ OCPP –ª–æ–≥—ñ–≤

–í—ñ–¥–∫—Ä–∏–π—Ç–µ http://172.16.0.40:8888/ –¥–ª—è –ø–µ—Ä–µ–≥–ª—è–¥—É OCPP –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å —É —Ñ–æ—Ä–º–∞—Ç—ñ HTML.

---

## üõ†Ô∏è –í–∏—Ä—ñ—à–µ–Ω–Ω—è –ø—Ä–æ–±–ª–µ–º

### EVerest –Ω–µ –ø—ñ–¥–∫–ª—é—á–∞—î—Ç—å—Å—è –¥–æ CitrineOS

1. **–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –º–µ—Ä–µ–∂—É:**
   ```bash
   ping 192.168.20.20
   nc -zv 192.168.20.20 8092
   ```

2. **–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —Ñ–∞—î—Ä–≤–æ–ª –Ω–∞ CitrineOS:**
   ```bash
   sudo ufw status
   ```

3. **–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –ª–æ–≥–∏ CitrineOS:**
   ```bash
   docker logs citrine-core | grep -i websocket
   ```

### –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏ –Ω–µ –∑–∞–ø—É—Å–∫–∞—é—Ç—å—Å—è

```bash
# –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –ª–æ–≥–∏
docker compose logs

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç—ñ—Ç—å
docker compose down
docker compose up -d --build
```

### –°—Ç–∞–Ω—Ü—ñ—è –Ω–µ –∑'—è–≤–ª—è—î—Ç—å—Å—è –≤ CitrineOS UI

1. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —â–æ `allowUnknownChargingStations: true` –≤ config.json CitrineOS
2. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –ª–æ–≥–∏ EVerest: `docker compose logs manager`
3. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ OCPP –ª–æ–≥–∏: http://172.16.0.40:8888/

---

## ‚öôÔ∏è –ö–æ—Ä–∏—Å–Ω—ñ –∫–æ–º–∞–Ω–¥–∏

```bash
# –°—Ç–∞—Ç—É—Å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ñ–≤
docker compose ps

# –õ–æ–≥–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º—É —á–∞—Å—ñ
docker compose logs -f

# –õ–æ–≥–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
docker compose logs -f manager

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫
docker compose restart

# –ó—É–ø–∏–Ω–∏—Ç–∏
docker compose down

# –ó–∞–ø—É—Å—Ç–∏—Ç–∏
docker compose up -d

# –ü–æ–≤–Ω–∞ –ø–µ—Ä–µ–±—É–¥–æ–≤–∞
docker compose down
docker compose up -d --build
```

---

## üìä –û—á—ñ–∫—É–≤–∞–Ω–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç

–ü—ñ—Å–ª—è —É—Å–ø—ñ—à–Ω–æ–≥–æ —Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è:

1. –í **CitrineOS UI** (http://192.168.20.20:3000/):
   - –ó'—è–≤–∏—Ç—å—Å—è —Å—Ç–∞–Ω—Ü—ñ—è `CP001`
   - –°—Ç–∞—Ç—É—Å: Online
   - 2 –∫–æ–Ω–µ–∫—Ç–æ—Ä–∏

2. –í **EVerest UI** (http://172.16.0.40:1880/ui/):
   - –°–∏–º—É–ª—è—Ç–æ—Ä –∑–∞—Ä—è–¥–Ω–æ—ó —Å—Ç–∞–Ω—Ü—ñ—ó
   - –ú–æ–∂–ª–∏–≤—ñ—Å—Ç—å —Å–∏–º—É–ª—é–≤–∞—Ç–∏ plug/unplug
   - –ú–æ–∂–ª–∏–≤—ñ—Å—Ç—å –∑–∞–ø—É—Å–∫–∞—Ç–∏/–∑—É–ø–∏–Ω—è—Ç–∏ –∑–∞—Ä—è–¥–∫—É
